<!DOCTYPE html>
<html lang="en">

<head>
	<!--meta tags-->
	<meta charset="UTF-8">
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">
	<meta name="robots" content="noindex, nofollow">
	<!--favicon-->
	<link rel="icon" href="assets/images/favicon.png" type="image/png">
	<!--css-->
	<link href="assets/lib/perfect-scrollbar/css/perfect-scrollbar.css" rel="stylesheet">
	<link href="assets/lib/metismenu/css/metisMenu.min.css" rel="stylesheet">
	<link href="assets/lib/bootstrap/bootstrap.min.css" rel="stylesheet">
	<!-- <link href="assets/lib/datatable/css/dataTables.bootstrap5.min.css" rel="stylesheet"> -->
	<link href="assets/css/main.css" rel="stylesheet">

	<title>明鉴智佐智能法医临床鉴定平台</title>
	<style>
		.popup {
			display: none;
			position: fixed;
			z-index: 1;
			left: 60%;
			top: 30%;
			width: 200px;
			padding: 20px;
			background-color: #f1f1f1;
			border: 1px solid #d3d3d3;
			border-radius: 4px;
			box-shadow: 0px 0px 10px 0px rgba(0,0,0,0.2);
			font-size: 25px;
			text-align: center;
		}
	</style>
</head>

<body>
	<!--preloader-->
	<div class="preloader"></div>
	<!--main wrapper start-->
	<div class="main-wrapper">
		<!--sidebar start -->
		<div class="sidebar">
			<div class="sidebar-header">
				<div class="title">
					<h6 style="text-align: center;color: var(--color-primary);">明鉴智佐智能法医临床鉴定平台</h6>
				</div>
				<div class="sidebar-toggle-icon ms-auto"><i class="fa fa-bars"></i>
				</div>
			</div>
			<!--navigation start-->
			<ul class="metismenu" id="menu">
				<li>
					<a href="index.html">
						<div class="icon"><i class="fas fa-house"></i>
						</div>
						<div class="title">首页</div>
					</a>

				</li>
						<li>
							<a href="javascript:void(0);" class="has-arrow">
								<div class="icon"><i class="fa fa-area-chart"></i></div>
								<div class="title">案件管理</div>
							</a>
							<ul>
								<li> <a href="caseManagement.html"><i class="fa fa-minus"></i>案件管理</a></li>
									<li><a href="caseInformation.html"><i class="fa fa-minus"></i>案件信息</a></li>
							</ul>
						</li>
						<li>
							<a href="javascript:void(0);" class="has-arrow">
								<div class="icon"><i class="fa fa-caret-up"></i></div>
								<div class="title">实验室信息</div>
							</a>
							<ul>
								<li> <a href="laboratoryInformation.html"><i class="fa fa-minus"></i>实验室信息</a></li>
									<li><a href="reagentInformation.html"><i class="fa fa-minus"></i>试剂信息</a></li>
							</ul>
						</li>
						<li>
							<a href="javascript:void(0);" class="has-arrow">
								<div class="icon"><i class="fa fa-female"></i></div>
								<div class="title">设备信息</div>
							</a>
							<ul>
								<li> <a href="equipmentInformation.html"><i class="fa fa-minus"></i>设备信息</a></li>
									<li><a href="personnelInformation.html"><i class="fa fa-minus"></i>人员信息</a></li>
							</ul>
						</li>
						<li>
							<a href="javascript:void(0);" class="has-arrow">
								<div class="icon"><i class="fa fa-external-link"></i></div>
								<div class="title">数据统计</div>
							</a>
							<ul>
								<li> <a href="dataStatistics.html"><i class="fa fa-minus"></i>数据统计</a></li>
							</ul>
						</li>
			</ul>
			<!--navigation end-->
		</div>

		<div class="main-content">
			<!--breadcrumb start-->
			<div class="page-title">
				<div class="row">
					<div class="col-6">
						<h3>人员信息</h3>
					</div>
					<div class="col-sm-6">
						<ol class="breadcrumb">
							<li class="breadcrumb-item"><a href="index.html">
									<i class="fa fa-home"></i>
								</a></li>
						</ol>
					</div>
				</div>
			</div>
			<!--breadcrumb end-->
			<div class="page-content">
				<div class="card">
					<div class="card-body">
						<div class="d-lg-flex align-items-center mb-4 gap-3">
                            	<div class="position-relative">
                                <input style="width: 200px;" type="text" placeholder="编号搜索..." class="form-control ps-5 radius-30 numberSearch">
                            	<span class="position-absolute top-50 product-show translate-middle-y"><i
										class="fa fa-magnifying-glass"></i></span>
                            	</div>
                            	<div class="position-relative">
                                <input style="width: 200px;" type="text" placeholder="姓名搜索..." class="form-control ps-5 radius-30 nameSearch">
                            	<span class="position-absolute top-50 product-show translate-middle-y"><i
										class="fa fa-magnifying-glass"></i></span>
                            	</div>
							<a href="javascript:void(0);"
								class="btn btn-primary radius-30 mt-2 mt-lg-0 listSearchBtn">搜索</a>

							<div class="ms-auto"><a href="addpersonnelInformation.html"
									class="btn btn-primary radius-30 mt-2 mt-lg-0 addFormList">新增</a></div>
						</div>
						<div class="table-responsive">
							<table class="table mb-0">
								<thead>
									<tr class="trTitle">

									</tr>
								</thead>
								<tbody class="NowTbody">

								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="overlay sidebar-toggle-icon">
		</div>

	</div>
		<header>
			<div class="topbar">
				<nav class="navbar navbar-expand">
					<div class="mobile-toggle-menu"><i class="fas fa-bars"></i>
					</div>
					<div class="top-menu ms-auto">
						<ul class="navbar-nav">
							<li class="nav-item mobile-search-icon">
								<a class="nav-link" href="#"><i class="fas fa-magnifying-glass"></i>
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="#" id="fullscreen-btn"><i class="fas fa-expand"></i>
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="#" id="nightmode-btn"><i class="fas fa-moon"></i>
								</a>
							</li>
							<li class="nav-item dropdown dropdown-large">
								<a class="nav-link dropdown-toggle dropdown-toggle-nocaret" href="#"
								   data-bs-toggle="dropdown" aria-expanded="false"> <span class="alert-count">4</span>
									<i class="fas fa-bell"></i>
								</a>
								<div class="dropdown-menu dropdown-menu-end">
									<div class="top-notifications-list" style="display: none;">
									</div>
								</div>
							</li>
							<li class="nav-item dropdown dropdown-large">
								<a class="nav-link dropdown-toggle dropdown-toggle-nocaret" href="#"
								   data-bs-toggle="dropdown" aria-expanded="false"> <span class="alert-count">4</span>
									<i class="fas fa-message"></i>

								</a>
								<div class="dropdown-menu dropdown-menu-end">
									<div class="top-message-list" style="display: none;">
									</div>
								</div>
							</li>
						</ul>
					</div>
					<div class="account-box dropdown">
						<a class="d-flex align-items-center nav-link dropdown-toggle dropdown-toggle-nocaret" href="#"
							data-bs-toggle="dropdown" aria-expanded="false">
							<img src="https://tianyantui.oss-cn-shenzhen.aliyuncs.com/data/1688700865050.u=2534210359,1730673110&fm=253&fmt=auto&app=120&f=JPEG" class="user-img" alt="user avatar">
							<div class="user-info ps-3">
								<p class="user-name">测试</p>
								<p class="designation">管理员</p>
							</div>
						</a>
						<ul class="dropdown-menu dropdown-menu-end">
							<li><a class="dropdown-item" href="javascript:void(0);"><i
										class="fas fa-right-from-bracket m-1"></i><span class="loginOut">退出登录</span></a>
							</li>
						</ul>
					</div>
				</nav>
			</div>
		</header>
		<!--header top end-->
	<!--javascript-->
	<script src="assets/lib/bootstrap/bootstrap.bundle.min.js"></script>
	<script src="assets/lib/jquery/jquery.min.js"></script>
	<script src="assets/lib/metismenu/js/metisMenu.min.js"></script>
	<script src="assets/lib/perfect-scrollbar/js/perfect-scrollbar.js"></script>
	<script src="http://mockjs.com/dist/mock.js"></script>
	<script src="assets/js/main.js"></script>
	<script>
		var arr = JSON.parse(localStorage.getItem('personnelInformation')) || [];
		const operate = () => {
			var addList = document.querySelectorAll('.addList');
			var addFormList = document.querySelectorAll('.addFormList');
			var deleteList = document.querySelectorAll('.deleteList');
			var goInfo = document.querySelectorAll('.goInfo');
			//新
			// 编辑
			addList.forEach(function (item, index) {
				item.onclick = function () {
					localStorage.setItem('personnelInformationItemInfo', JSON.stringify(arr[index]))
					location.href = 'addpersonnelInformation.html'
				}
			})
			// 删除
			deleteList.forEach(function (item, index) {
				item.onclick = function () {
					arr.splice(index, 1);
					localStorage.setItem('personnelInformation', JSON.stringify(arr));
					setInterval(function () {
						location.reload();
					}, 2000)
				}
			})
			// 跳转详情页
			goInfo.forEach(function (item, index) {
				item.onclick = function () {
					localStorage.setItem('personnelInformationDetail', JSON.stringify(arr[index]));
					location.href = 'personnelInformationDetail.html'
				}
			})
		}
		try{
			Mock.mock("getpersonnelInformationList", {'list|1-10': [{
					"id|+1": 1,
							'编号': '@string("upper", 8)',
							'姓名': '@cname()',
					'性别|1': [
						'男',
						'女',
					],
							'职业': '@cword(5)',
					'联系方式': /^1[3-9]{9}$/,
							'审核人': '@cword(5)',
							'审核时间': '@date("yyyy-MM-dd hh:mm:ss")',
				}
				]});
		}catch (e) {
		}
		const tbody = document.querySelector('.NowTbody')

		// 列表渲染
		  const getList = () => {
        tbody.innerHTML = ''
        arr.forEach(function (item, index) {
            const tBody = Object.values(item);
            tbody.innerHTML += `
          <tr>
             ${tBody.map((tBodyitem, index) => {
                    if (typeof tBodyitem === 'number') {
                        return `<th style="text-align:center;vertical-align:middle"> ${tBodyitem}</th>`
        }
        if (tBodyitem.slice(0, 4) === 'http') {
            return `<th><img src="${tBodyitem}" alt="" style="width:100px;height:100px;"></th>`
        }
        return `<th style="text-align:center;vertical-align:middle"> ${tBodyitem}</th>`
    }).join('')}
		<td style="text-align:center;vertical-align:middle;"><button type="button" class="btn btn-primary btn-sm radius-30 px-4 goInfo" >查看详情</button></td>
		<td style="text-align:center;vertical-align:middle;">
				<a href="javascript:void(0);" class="btn btn-primary btn-action addList"><i
		class="fa fa-edit"></i></span></a>
		<a href="javascript:void(0);" class="btn btn-danger btn-action deleteList" id="swal-3"><i
		class="fa fa-trash"></i></a>
		</td>
		</tr>`
            })
        }
		// 如果列表不为空，获取列表标题
		if(arr.length>0) {
			const trTitle = document.querySelector('.trTitle');
			const titleArr = Object.keys(arr[0])
			let tableHTML = '';
			titleArr.forEach(titleItem => {
				tableHTML += '<th style="text-align:center;display:"flex;vertical-align:middle;" scope="col">' + titleItem + '</th>';
			});
			tableHTML += '<th style="text-align:center;display:"flex;vertical-align:middle;" scope="col">查看详情</th>' +
					'<th style="text-align:center;display:"flex;vertical-align:middle;" scope="col">行动</th>';
			trTitle.innerHTML = tableHTML;
			getList();
		}
		if(arr.length == 0){
			try{
				getAjaxinfo();
			}catch(e){
				arr = []
			}
		}
		function getAjaxinfo(){
			$.ajax({
				url: "getpersonnelInformationList", //请求的url地址
				dataType: "json", //返回格式为json
				data: {}, //参数值
				type: "get", //请求方式
				success: function (req) {
					localStorage.setItem('personnelInformation',JSON.stringify(req.list));
					arr = req.list;
					const trTitle = document.querySelector('.trTitle');
					const titleArr = Object.keys(arr[0])
					let tableHTML = '';
					titleArr.forEach(titleItem => {
						tableHTML += '<th style="text-align:center;vertical-align:middle;">' + titleItem + '</th>';
					});
					tableHTML += '<th style="text-align:center;display:"flex;vertical-align:middle;" scope="col">查看详情</th>' +
							'<th style="text-align:center;display:"flex;vertical-align:middle;" scope="col">行动</th>';
					trTitle.innerHTML = tableHTML;
					getList();
					operate();
				},
			});
		};

		// 搜索功能
		const searchBtn = document.querySelector('.listSearchBtn');
		// 点击搜索
		searchBtn.addEventListener('click', function () {
			arr = JSON.parse(localStorage.getItem('personnelInformation'));
			const numberSearchValue = document.querySelector('.numberSearch').value
			if (document.querySelector('.numberSearch').value != '' ) {
				const newArr = arr.filter(item => item.编号.includes(numberSearchValue))
				arr = newArr;
			}
			const nameSearchValue = document.querySelector('.nameSearch').value
			if (document.querySelector('.nameSearch').value != '' ) {
				const newArr = arr.filter(item => item.姓名.includes(nameSearchValue))
				arr = newArr;
			}
			// 获取列表
			getList()
			// 列表操作
			operate();
		})
		operate();

		// 退出登录
		const loginOut = document.querySelector('.loginOut');
		loginOut.addEventListener('click', () => {
			window.location.href = 'login.html';
		})
	</script>
	<script src="assets/lib/sweetalert/sweetalert.min.js"></script>
	<script src="assets/js/pages/sweetalert.js"></script>
</body>

</html>